<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Darknet Videochat ‚Äî Peer Connect</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      margin: 0;
      font-family: monospace;
      background: linear-gradient(180deg, #000, #111);
      color: #ff9900;
      min-height: 200vh; /* —á—Ç–æ–±—ã –±—ã–ª —Å–∫—Ä–æ–ª–ª */
    }
    h1 {
      text-align: center;
      font-size: 3rem;
      margin-top: 2rem;
      text-shadow: 0 0 10px #ff9900;
    }
    #webrtc-module {
      width: 360px;
      background: rgba(0,0,0,0.85);
      border: 2px solid #ff9900;
      border-radius: 12px;
      padding: 10px;
      color: #ff9900;
      font-family: monospace;
      margin: 2rem auto; /* —Ü–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –∏ –±–ª–æ–∫ —Å–∫—Ä–æ–ª–ª–∏—Ç—Å—è */
    }
    #webrtc-module video {
      width: 100%;
      border-radius: 8px;
      margin-bottom: 6px;
    }
    .btn {
      padding: .5rem 1rem;
      border-radius: .5rem;
      font-weight: 800;
      border: 2px solid #ff9900;
      color: #ff9900;
      background: #000;
      cursor: pointer;
      margin-top: 4px;
      width: 48%;
    }
    .btn:hover {
      background: #ff9900;
      color: #000;
    }
    textarea {
      width: 100%;
      background: #000;
      color: #ff9900;
      border: 1px solid #ff9900;
      border-radius: 6px;
      margin-top: 4px;
    }
    .flex-between { display: flex; justify-content: space-between; }
  </style>
</head>
<body>

<h1>üíª Darknet Videochat ‚Äî Peer Connect</h1>
<p style="text-align:center; margin:2rem;">–ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É ‚Äî –≤–∏–¥–µ–æ—á–∞—Ç —Ç–µ–ø–µ—Ä—å –ø—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º.</p>

<div id="webrtc-module">
  <h3 style="text-align:center; margin-bottom:10px;">üîó Peer Video</h3>
  <video id="localPeerVideo" autoplay muted></video>
  <video id="remotePeerVideo" autoplay></video>

  <div class="flex-between">
    <button id="createOfferBtn" class="btn">üìù –°–æ–∑–¥–∞—Ç—å –æ—Ñ—Ñ–µ—Ä</button>
    <button id="acceptOfferBtn" class="btn">‚úÖ –ü—Ä–∏–Ω—è—Ç—å –æ—Ñ—Ñ–µ—Ä</button>
  </div>

  <div id="offerBlock" style="display:none; margin-top:6px;">
    <p>–û—Ç–ø—Ä–∞–≤—å—Ç–µ –¥—Ä—É–≥–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é:</p>
    <textarea id="offerOutput" style="height:80px;"></textarea>
  </div>

  <div id="answerBlock" style="display:none; margin-top:6px;">
    <p>–í—Å—Ç–∞–≤—å—Ç–µ –æ—Ñ—Ñ–µ—Ä –¥—Ä—É–≥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</p>
    <textarea id="incomingOffer" style="height:80px;"></textarea>
    <button id="applyOfferBtn" class="btn" style="width:100%; margin-top:4px;">–ü—Ä–∏–Ω—è—Ç—å –æ—Ñ—Ñ–µ—Ä –∏ —Å–æ–∑–¥–∞—Ç—å –æ—Ç–≤–µ—Ç</button>
  </div>

  <div id="answerOutputBlock" style="display:none; margin-top:6px;">
    <p>–û—Ç–ø—Ä–∞–≤—å—Ç–µ –æ—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é A:</p>
    <textarea id="answerOutput" style="height:80px;"></textarea>
  </div>
</div>

<script>
(async () => {
  const localVideo = document.getElementById('localPeerVideo');
  const remoteVideo = document.getElementById('remotePeerVideo');
  const createOfferBtn = document.getElementById('createOfferBtn');
  const acceptOfferBtn = document.getElementById('acceptOfferBtn');
  const offerBlock = document.getElementById('offerBlock');
  const offerOutput = document.getElementById('offerOutput');
  const answerBlock = document.getElementById('answerBlock');
  const incomingOffer = document.getElementById('incomingOffer');
  const applyOfferBtn = document.getElementById('applyOfferBtn');
  const answerOutputBlock = document.getElementById('answerOutputBlock');
  const answerOutput = document.getElementById('answerOutput');

  const pc = new RTCPeerConnection({ iceServers: [{ urls: 'stun:stun.l.google.com:19302' }] });
  const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
  stream.getTracks().forEach(track => pc.addTrack(track, stream));
  localVideo.srcObject = stream;

  pc.ontrack = e => { remoteVideo.srcObject = e.streams[0]; };

  createOfferBtn.onclick = async () => {
    const offer = await pc.createOffer();
    await pc.setLocalDescription(offer);
    offerOutput.value = JSON.stringify(offer);
    offerBlock.style.display = 'block';
    answerBlock.style.display = 'block';
  };

  applyOfferBtn.onclick = async () => {
    if (!incomingOffer.value) return alert("–í—Å—Ç–∞–≤—å—Ç–µ –æ—Ñ—Ñ–µ—Ä!");
    const offer = JSON.parse(incomingOffer.value);
    await pc.setRemoteDescription(offer);
    const answer = await pc.createAnswer();
    await pc.setLocalDescription(answer);
    answerOutput.value = JSON.stringify(answer);
    answerOutputBlock.style.display = 'block';
  };

  window.applyPeerAnswer = async (answerJSON) => {
    const answer = JSON.parse(answerJSON);
    await pc.setRemoteDescription(answer);
    alert("–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!");
  };
})();
</script>

</body>
</html>
